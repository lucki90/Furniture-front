<div>
  <div *ngIf="errorMessage" class="error-message">
    {{ errorMessage }}
  </div>
  <div>
    <h3>Wizualizacja szafki</h3>
    <canvas id="cabinetCanvas" width="400" height="400" style="border:1px solid #ddd;"></canvas>
  </div>
  <h2>Oblicz parametry szafki</h2>
  <form>
    <div class="form-row">
      <!-- Pierwsza kolumna: Wymiary, półki, przełączniki -->
      <div class="dimensions-and-switches">
        <label>
          Wysokość (mm)
          <input type="number" [(ngModel)]="height" name="height" />
        </label>
        <label>
          Szerokość (mm)
          <input type="number" [(ngModel)]="width" name="width" />
        </label>
        <label>
          Głębokość (mm)
          <input type="number" [(ngModel)]="depth" name="depth" />
        </label>
        <label>
          Liczba półek
          <input type="number" [(ngModel)]="shelfQuantity" name="shelfQuantity" />
        </label>
        <!-- Przełącznik jeden/dwa fronty -->
        <label>
          Typ frontu
          <select [(ngModel)]="frontType" name="frontType">
            <option *ngFor="let type of frontTypes" [value]="type.value">
              {{ type.label }}
            </option>
          </select>
        </label>

        <!-- Pole widoczne tylko przy wyborze DRAWER -->
        <div *ngIf="frontType === 'DRAWER'">
          <label>
            Ilość szuflad
            <input type="number" [(ngModel)]="drawerQuantity" name="drawerQuantity" min="1" />
          </label>
        </div>


        <!-- Przełącznik plecki hdf -->
        <label>
          <span>{{ needBacks ? 'Plecki HDF' : 'Brak plecków' }}</span>
          <label class="switch">
            <input type="checkbox" [(ngModel)]="needBacks" name="needBacks" />
            <span class="slider"></span>
            <span class="tooltip">Czy dodac plecy z płyty HDF</span>
          </label>
        </label>
      </div>

      <!-- Druga kolumna: Materiał korpusu i frontu -->
      <div class="materials">
        <label>
          Materiał korpusu
          <select [(ngModel)]="boxMaterial" name="boxMaterial">
            <option *ngFor="let material of materials" [value]="material.value">
              {{ material.label }}
            </option>
          </select>
        </label>
        <label>
          Grubość korpusu (mm)
          <select [(ngModel)]="boxBoardThickness" name="boxBoardThickness">
            <option *ngFor="let thickness of thicknesses" [value]="thickness">
              {{ thickness }}
            </option>
          </select>
        </label>
        <label>
          Kolor korpusu
          <select [(ngModel)]="boxColor" name="boxColor">
            <option *ngFor="let color of colors" [value]="color">{{ color }}</option>
          </select>
        </label>
        <label>
          Materiał frontu
          <select [(ngModel)]="frontMaterial" name="frontMaterial">
            <option *ngFor="let material of materials" [value]="material.value">
              {{ material.label }}
            </option>
          </select>
        </label>
        <!-- Przełącznik czy lakierowany front -->
        <label *ngIf="frontMaterial === 'MDF'">
          <span>{{ varnishedFront ? 'Front Lakierowany' : 'Front z okleiną' }}</span>
          <label class="switch">
            <input type="checkbox" [(ngModel)]="varnishedFront" name="varnishedFront" />
            <span class="slider"></span>
            <span class="tooltip">Fronty z okleiną czy lakierowane?</span>
          </label>
        </label>
        <label>
          Grubość frontu (mm)
          <select [(ngModel)]="frontBoardThickness" name="frontBoardThickness">
            <option *ngFor="let thickness of thicknesses" [value]="thickness">
              {{ thickness }}
            </option>
          </select>
        </label>
        <label>
          Kolor frontu
          <select [(ngModel)]="frontColor" name="frontColor">
            <option *ngFor="let color of colors" [value]="color">{{ color }}</option>
          </select>
        </label>
      </div>
    </div>
    <button type="button" (click)="calculateCabinet()">Oblicz</button>
  </form>


  <div *ngIf="response" class="response-container">
    <h3>Lista płyt:</h3>

    <table>
      <thead>
        <tr>
          <th>ID</th>
          <th>Nazwa płyty</th>
          <th>sztuk</th>
          <th>Długość</th>
          <th>Okleina</th>
          <th>Szerokość</th>
          <th>Okleina</th>
          <th>Grubość płyty</th>
          <th>Malowana</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let board of response.boardList; index as i">
          <td>{{ i + 1 }}</td>
          <td>{{ board.boardName }}</td>
          <td>{{ board.quantity }}</td>
          <td>{{ board.sideX ?? 'N/A' }}</td>
          <td>{{ board.veneerX ?? 'N/A' }}</td>
          <td>{{ board.sideY }}</td>
          <td>{{ board.veneerY }}</td>
          <td>{{ board.boardThickness ?? '1.8' }}</td>
          <td>{{ board.varnished ? 'TAK' : 'NIE' }}</td>
        </tr>
      </tbody>
    </table>
    <h3>Lista potrzenych elementów:</h3>
    <table>
      <thead>
        <tr>
          <th>ID</th>
          <th>Nazwa elementu</th>
          <th>Ilość</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let component of response.componentList; index as i">
          <td>{{ i + 1 }}</td>
          <td>{{ component.componentName }}</td>
          <td>{{ component.quantity ?? '0' }}</td>
        </tr>
      </tbody>
    </table>
  </div>


</div>